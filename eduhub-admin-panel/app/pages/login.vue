<template>
  <div class="min-h-screen bg-gray-50 dark:bg-gray-900 font-sans antialiased">
    <div
      class="min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center px-4"
    >
      <div
        class="lg:w-[50%] grid grid-cols-1 lg:grid-cols-2 gap-0 bg-white dark:bg-gray-900 rounded-2xl shadow-lg overflow-hidden"
      >
        <!-- Illustration Section -->
        <div
          class="hidden lg:flex items-center justify-center bg-white dark:bg-gray-800 p-10"
        >
          <img
            src="assets/images/agency.png"
            alt="ØªÙˆØ¶ÙŠØ­"
            class="w-full max-w-md object-contain"
            @error="handleImageError"
          />
        </div>

        <!-- Login Form Section -->
        <div
          class="flex flex-col justify-center px-6 sm:px-10 md:px-14 py-16 bg-gray-50 dark:bg-gray-900 text-right"
        >
          <div class="mb-10">
            <h1
              class="text-4xl md:text-5xl font-bold text-gray-900 dark:text-white mb-3"
            >
              ðŸ‘‹ Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ
            </h1>
            <p class="text-gray-600 dark:text-gray-400 text-base md:text-lg">
              Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø§Ø¨Ùƒ Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
            </p>
          </div>

          <UForm @submit.prevent class="space-y-6">
            <div
              class="flex items-center justify-between text-sm text-gray-500 dark:text-gray-400"
            >
              <UFormGroup label="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" name="email" class="w-full">
                <UInput
                  v-model="form.email"
                  icon="i-lucide-mail"
                  placeholder="example@email.com"
                  type="email"
                  size="lg"
                  variant="outline"
                  class="w-full"
                />
              </UFormGroup>
            </div>
            <div
              class="flex items-center justify-between text-sm text-gray-500 dark:text-gray-400"
            >
              <UFormGroup label="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" name="password" class="w-full">
                <UInput
                  v-model="form.password"
                  icon="i-lucide-lock"
                  placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                  type="password"
                  size="lg"
                  variant="outline"
                  class="w-full"
                />
              </UFormGroup>
            </div>
            <div
              class="flex items-center justify-between text-sm text-gray-500 dark:text-gray-400"
            >
              <label class="flex items-center gap-2">
                <UCheckbox />
                <span>ØªØ°ÙƒØ±Ù†ÙŠ</span>
              </label>
              <NuxtLink to="#" class="text-yellow-600 hover:underline">
                Ù†Ø³ÙŠØª ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±ØŸ
              </NuxtLink>
            </div>

            <UButton
              block
              size="lg"
              color="primary"
              class="font-semibold text-lg py-3"
              @click="onLogin"
            >
              ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
            </UButton>
          </UForm>

          <!-- <p
            class="text-center text-base text-gray-600 dark:text-gray-400 mt-10"
          >
            Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ
            <NuxtLink
              to="#"
              class="text-yellow-600 hover:underline font-semibold"
            >
              Ø£Ù†Ø´Ø¦ Ø­Ø³Ø§Ø¨Ù‹Ø§
            </NuxtLink>
          </p> -->
        </div>
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref } from "vue";
import { useRouter } from "vue-router";
import { useFetch } from "#app";

const form = ref({
  email: "",
  password: "",
});
definePageMeta({ layout: "auth" });

const handleImageError = (event) => {
  event.target.onerror = null;
  event.target.src =
    "https://placehold.co/500x500/FFF8E1/E6B34A?text=Illustration";
};

const router = useRouter();

const onLogin = async () => {
  try {
    const { data, error } = await useFetch("/api/auth/login", {
      method: "POST",
      body: JSON.stringify(form.value),
      headers: {
        "Content-Type": "application/json",
      },
    });

    if (error.value) {
      console.error("Login failed:", error.value);
      return;
    }

    // Success: Redirect to dashboard or home
    router.push("/");
  } catch (err) {
    console.error("Unexpected error:", err);
  }
};
</script>

<style scoped></style>
